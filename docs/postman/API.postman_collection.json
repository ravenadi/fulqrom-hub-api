{
	"info": {
		"_postman_id": "2f8f58dc-ba25-45c8-bde5-cd2718183bc2",
		"name": "Fulqrom Hub API",
		"description": "Fulqrom Hub REST API - Australian commercial real estate and HVAC&R building management platform\n\n## Authentication\nThis collection uses Auth0 for authentication. Use the \"Auth0 Login\" request to get your access token, which will be automatically saved to the collection variable `access_token`.\n\n## Setup\n1. Import this collection into Postman\n2. Set up environment variables (or use collection variables)\n3. Run \"Auth0 Login\" to get your token\n4. All other requests will use the token automatically\n\n## Variables\n- `AUTH0_DOMAIN`: dev-ml7pxvj6vg32j740.au.auth0.com\n- `AUTH0_CLIENT_ID`: Your Auth0 client ID\n- `AUTH0_AUDIENCE`: https://api.fulqrom.com.au\n- `API_BASE_URL`: http://localhost:30001",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "876650",
		"_collection_link": "https://solar-space-808742.postman.co/workspace/b4db7914-c8b9-4da3-8973-55c4c4d47321/collection/876650-2f8f58dc-ba25-45c8-bde5-cd2718183bc2?action=share&source=collection_link&creator=876650"
	},
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "✅ Auth0 Login (Client Credentials) - USE THIS",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Save the access token to both collection and environment variables",
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.collectionVariables.set(\"access_token\", jsonData.access_token);",
									"    pm.collectionVariables.set(\"token_type\", jsonData.token_type);",
									"    pm.environment.set(\"access_token\", jsonData.access_token);",
									"    pm.environment.set(\"token_type\", jsonData.token_type);",
									"    ",
									"    console.log(\"✓ Access token saved successfully\");",
									"    console.log(\"Token expires in:\", jsonData.expires_in, \"seconds\");",
									"    console.log(\"⚠ Now call 'BFF Login' to create session cookies\");",
									"} else {",
									"    console.log(\"✗ Authentication failed\");",
									"}"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"grant_type\": \"http://auth0.com/oauth/grant-type/password-realm\",\n  \"scope\": \"{{auth0_scope}}\",\n  \"client_id\": \"{{AUTH0_CLIENT_ID}}\",\n  \"client_secret\": \"{{AUTH0_CLIENT_SECRET}}\",\n  \"audience\": \"{{AUTH0_AUDIENCE}}\",\n  \"username\": \"{{auth0_username}}\",\n  \"password\": \"{{auth0_password}}\",\n  \"realm\": \"Username-Password-Authentication\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "https://{{AUTH0_DOMAIN}}/oauth/token",
							"protocol": "https",
							"host": [
								"{{AUTH0_DOMAIN}}"
							],
							"path": [
								"oauth",
								"token"
							]
						},
						"description": "✅ **THIS WORKS!** - Machine-to-machine authentication\n\nUse this for testing the API in Postman. This grant type authenticates as the application itself (not as a specific user).\n\n**What you get:**\n- Valid access token for API calls\n- No user context (no user-specific permissions)\n- Works without any Auth0 setup changes\n\n**Steps:**\n1. Click Send\n2. Token automatically saved\n3. Use any protected endpoint\n\n**Required Variables:**\n- `AUTH0_DOMAIN`: dev-ml7pxvj6vg32j740.au.auth0.com\n- `AUTH0_CLIENT_ID`: L3JN7NIRm67O9wBfxex1jRQJZwIUt6cq\n- `AUTH0_CLIENT_SECRET`: Your client secret\n- `AUTH0_AUDIENCE`: https://api.fulqrom.com.au"
					},
					"response": []
				},
				{
					"name": "Sync User (Run First Time)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    console.log(\"✓ User synced successfully\");",
									"    console.log(\"✓ User now exists in database\");",
									"} else {",
									"    console.log(\"✗ User sync failed\");",
									"}"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"auth0_id\": \"auth0|68f0a977ff172d1b1b0f8d5c\",\n  \"email\": \"{{auth0_username}}\",\n  \"full_name\": \"Demo User\",\n  \"phone\": \"+61400000000\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{API_BASE_URL}}/api/auth/sync-user",
							"host": [
								"{{API_BASE_URL}}"
							],
							"path": [
								"api",
								"auth",
								"sync-user"
							]
						},
						"description": "Sync or create user from Auth0 to MongoDB database. This is a public endpoint that creates the user record if it doesn't exist.\n\n**Run this ONCE before using BFF Login if the user doesn't exist in the database.**\n\nNote: Replace auth0_id with the actual Auth0 user ID from your Auth0 dashboard."
					},
					"response": []
				},
				{
					"name": "BFF Login (Create Session)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Session cookies are automatically saved by Postman",
									"if (pm.response.code === 200) {",
									"    console.log(\"✓ Session created successfully\");",
									"    console.log(\"✓ Session cookies (sid, csrf) are now active\");",
									"    console.log(\"✓ You can now call protected endpoints\");",
									"} else {",
									"    console.log(\"✗ Session creation failed\");",
									"}"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"remember_me\": true\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{API_BASE_URL}}/api/auth/login",
							"host": [
								"{{API_BASE_URL}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						},
						"description": "Create a server-side session from the Auth0 token. This sets HttpOnly cookies (sid, csrf) that will be used for all subsequent API calls.\n\n**Steps:**\n1. Run \"Auth0 Login\" first to get the access token\n2. Run this endpoint to create session cookies\n3. All other endpoints will use the session cookies automatically\n\n**Response:**\n- Sets `sid` cookie (HttpOnly, session ID)\n- Sets `csrf` cookie (CSRF protection)\n- Returns user information and session metadata"
					},
					"response": []
				},
				{
					"name": "Get Current User (/auth/me)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{API_BASE_URL}}/api/auth/me",
							"host": [
								"{{API_BASE_URL}}"
							],
							"path": [
								"api",
								"auth",
								"me"
							]
						},
						"description": "Get current authenticated user information. Uses session cookies for authentication."
					},
					"response": []
				},
				{
					"name": "Logout",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{API_BASE_URL}}/api/auth/logout",
							"host": [
								"{{API_BASE_URL}}"
							],
							"path": [
								"api",
								"auth",
								"logout"
							]
						},
						"description": "Invalidate current session and clear cookies."
					},
					"response": []
				}
			],
			"description": "Auth0 authentication endpoints for obtaining access tokens and BFF session management."
		},
		{
			"name": "Dashboard",
			"item": [
				{
					"name": "Portfolio Map",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{API_BASE_URL}}/api/analytics/buildings/coordinates",
							"host": [
								"{{API_BASE_URL}}"
							],
							"path": [
								"api",
								"analytics",
								"buildings",
								"coordinates"
							]
						},
						"description": "Example of a protected endpoint that requires authentication.\n\nThis request will automatically use the Bearer token from the collection variable `access_token`."
					},
					"response": []
				}
			]
		},
		{
			"name": "Customer",
			"item": [
				{
					"name": "List Customers",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{API_BASE_URL}}/api/customers?search=&limit=50",
							"host": [
								"{{API_BASE_URL}}"
							],
							"path": [
								"api",
								"customers"
							],
							"query": [
								{
									"key": "search",
									"value": "",
									"description": "Search term (optional)"
								},
								{
									"key": "limit",
									"value": "50",
									"description": "Maximum number of results (optional, default: 50)"
								}
							]
						},
						"description": "List all customers with optional search and limit parameters. Results are automatically filtered by tenant."
					},
					"response": []
				},
				{
					"name": "Get Customer",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{API_BASE_URL}}/api/customers/:id",
							"host": [
								"{{API_BASE_URL}}"
							],
							"path": [
								"api",
								"customers",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "",
									"description": "Customer ID"
								}
							]
						},
						"description": "Get a single customer by ID with full details. Replace :id in the URL with the actual customer ID."
					},
					"response": []
				},
				{
					"name": "Create Customer",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"organisation\": {\n    \"organisation_name\": \"Example Property Management\"\n  },\n  \"company_profile\": {\n    \"business_number\": \"12345678901\",\n    \"trading_name\": \"EPM Properties\"\n  }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{API_BASE_URL}}/api/customers",
							"host": [
								"{{API_BASE_URL}}"
							],
							"path": [
								"api",
								"customers"
							]
						},
						"description": "Create a new customer. The organisation_name is required. Business number (ABN) and trading name are optional."
					},
					"response": []
				},
				{
					"name": "Update Customer",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"organisation\": {\n    \"organisation_name\": \"Updated Property Management\"\n  },\n  \"company_profile\": {\n    \"business_number\": \"12345678901\",\n    \"trading_name\": \"Updated Trading Name\"\n  }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{API_BASE_URL}}/api/customers/:id",
							"host": [
								"{{API_BASE_URL}}"
							],
							"path": [
								"api",
								"customers",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "",
									"description": "Customer ID"
								}
							]
						},
						"description": "Update an existing customer by ID. Replace :id in the URL with the actual customer ID."
					},
					"response": []
				}
			]
		},
		{
			"name": "Building",
			"item": []
		},
		{
			"name": "Asset",
			"item": []
		},
		{
			"name": "Vendor",
			"item": []
		},
		{
			"name": "Document",
			"item": []
		},
		{
			"name": "Health Check",
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{API_BASE_URL}}/health",
					"host": [
						"{{API_BASE_URL}}"
					],
					"path": [
						"health"
					]
				},
				"description": "Check API health status (no authentication required)"
			},
			"response": []
		}
	],
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{access_token}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// This runs before each request",
					"// You can add logic here to check if token is expired and refresh automatically"
				]
			}
		}
	],
	"variable": [
		{
			"key": "AUTH0_DOMAIN",
			"value": "dev-ml7pxvj6vg32j740.au.auth0.com",
			"type": "string"
		},
		{
			"key": "AUTH0_CLIENT_ID",
			"value": "L3JN7NIRm67O9wBfxex1jRQJZwIUt6cq",
			"type": "string"
		},
		{
			"key": "AUTH0_CLIENT_SECRET",
			"value": "JZ72w4a9tmP6ovvYSsDLBWiU86APV_1zPL05p__lg6YIjGgrJnS5tK77UP63CHB0",
			"type": "string"
		},
		{
			"key": "AUTH0_AUDIENCE",
			"value": "https://api.fulqrom.com.au",
			"type": "string"
		},
		{
			"key": "AUTH0_CONNECTION",
			"value": "Username-Password-Authentication",
			"type": "string"
		},
		{
			"key": "API_BASE_URL",
			"value": "http://localhost:30001",
			"type": "string"
		},
		{
			"key": "auth0_username",
			"value": "demo@fulqrom.com.au",
			"type": "string"
		},
		{
			"key": "auth0_password",
			"value": "",
			"type": "string"
		},
		{
			"key": "access_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "id_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "token_type",
			"value": "Bearer",
			"type": "string"
		}
	]
}